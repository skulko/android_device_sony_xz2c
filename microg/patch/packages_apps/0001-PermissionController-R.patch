From e65c4bb3ad54c775b81f6619a4269e86c03ccf4a Mon Sep 17 00:00:00 2001
From: Laurence S <23030592+skulko@users.noreply.github.com>
Date: Sat, 12 Jun 2021 22:45:41 +0200
Subject: [PATCH] Signature spoofing patch for R (2/2)

Change-Id: Ifbdbfc8db368077b96ad92dd4fb5410552eedff9
---
 .../android/permissioncontroller/permission/utils/Utils.java   | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/com/android/permissioncontroller/permission/utils/Utils.java b/src/com/android/permissioncontroller/permission/utils/Utils.java
index 65fdd590a..c8f83974e 100644
--- a/src/com/android/permissioncontroller/permission/utils/Utils.java
+++ b/src/com/android/permissioncontroller/permission/utils/Utils.java
@@ -23,6 +23,7 @@ import static android.Manifest.permission_group.CALENDAR;
 import static android.Manifest.permission_group.CALL_LOG;
 import static android.Manifest.permission_group.CAMERA;
 import static android.Manifest.permission_group.CONTACTS;
+import static android.Manifest.permission_group.FAKE_PACKAGE;
 import static android.Manifest.permission_group.LOCATION;
 import static android.Manifest.permission_group.MICROPHONE;
 import static android.Manifest.permission_group.PHONE;
@@ -209,6 +210,8 @@ public final class Utils {
 
         PLATFORM_PERMISSIONS.put(Manifest.permission.BODY_SENSORS, SENSORS);
 
+	 PLATFORM_PERMISSIONS.put(Manifest.permission.FAKE_PACKAGE_SIGNATURE, FAKE_PACKAGE);
+
         PLATFORM_PERMISSION_GROUPS = new ArrayMap<>();
         int numPlatformPermissions = PLATFORM_PERMISSIONS.size();
         for (int i = 0; i < numPlatformPermissions; i++) {
-- 
2.31.1

